from pyrogram import Client, filters
from pyrogram.types import Message
from config import Config

@Client.on_message(filters.command("profile") & filters.private)
async def profile_handler(client, message: Message):
    user = message.from_user
    user_id = user.id
    full_name = user.first_name + (f" {user.last_name}" if user.last_name else "")
    username = f"@{user.username}" if user.username else "None"
    mention = user.mention

    try:
        # Try to get user's profile photo
        photos = await client.get_profile_photos(user_id)
        photo = photos.photos[0].file_id if photos.total_count > 0 else None
    except:
        photo = None

    caption = (
        f"ðŸ‘¤ Your Profile Info\n\n"
        f"Full Name: {full_name}\n"
        f"Username: {username}\n"
        f"Telegram ID: {user_id}\n"
        f"Mention: {mention}\n\n"
        f"ðŸ”§ Powered by AkashOP"
    )

    if photo:
        await message.reply_photo(photo=photo, caption=caption)
    else:
        await message.reply_text(caption)
